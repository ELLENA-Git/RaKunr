## 环境准备
### Node.js

Hexo 基于 Node.js 开发，所以我们需要在本地搭建起环境。
到 [Node.js](http://nodejs.org) 官网下载相应平台的最新版本。

* * *

### Git

Git 的客户端我用的是 [Git-Scm](http://git-scm.com) ，点击下载，然后安装配置，基本没有什么要设置的。

## Gitcafe / GitHub

我们首先需要注册个账号, 当然你可以选择使用一方或者都用。

### 基本设置

首先设置你的用户名和邮箱：

```bash
git config --global user.email "{Email}"
git config --global user.name "{UserName}"
```

### SSH Key

创建 `.ssh` 目录

```bash
mkdir ~/.ssh
cd ~/.ssh
```

生成密匙：

```bash
ssh-keygen -t rsa -C "your_email@example.com"
# 用私人邮箱创建一个密匙
# Generating public/private rsa key pair.
# Enter file in which to save the key (/c/Users/you/.ssh/id_rsa): [Press enter]
```

输入密匙密码

```bash
Enter passphrase (empty for no passphrase): [Type a passphrase]
# Enter same passphrase again: [Type passphrase again]
```

最后你会得到 类似下面的结果

```bash
Your identification has been saved in /c/Users/you/.ssh/id_rsa.
# Your public key has been saved in /c/Users/you/.ssh/id_rsa.pub.
# The key fingerprint is:
# 01:0f:f4:3b:ca:85:d6:17:a1:7d:f0:68:9d:f0:a2:db your_email@example.com
```

你需要把他添加到 ssh-agents 里去

```bash
# start the ssh-agent in the background
eval "$(ssh-agent -s)"
# Agent pid 59566
ssh-add ~/.ssh/id_rsa
```

然后打开目录下的 id_rsa 把内容复制到对应位置：
GitHub: 『Account settings -&gt; SSH Keys -&gt; Add SSH Key』
GitCafe: 『账户设置 -&gt; SSH公匙管理 -&gt; 添加新的公匙』

### Project

然后创建项目
GitHub: 项目名 『username.github.io』
GitCafe: 项目名 『username』

* * *

## Hexo

### 安装

```bash
mkdir blog
npm install hexo -g

hexo init blog
cd blog

npm install
hexo server
```

你的 Hexo 就在本地部署好了，浏览器输入 [http://localhost:4000](http://localhost:4000) 就可以看到效果。

### 生成静态页面

在 blog 目录下

```bash
hexo generate
```

命令必须在init目录下执行，否则不成功，但是也不报错。
当你修改文章Tag或内容，不能正确重新生成内容，可以删除 hexo/db.json 后重试，还不行就到 public 目录删除对应的文件，重新生成。

### 配置Git

打开 _config.yml
如果你是 Github

```yaml
deploy:
  type: github
  repository: git@github.com:Kunr/kunr.github.io.git
  branch: master
```

如果你是 Gitcafe

```yaml
deploy:
  type: github
  repository: git@gitcafe.com:kunr/kunr.git
  branch: gitcafe-pages
```

或者，你两个都有

```yaml
deploy:
  type: git
  message: ''
  repo:
  github: git@github.com:Kunr/kunr.github.io.git, master
  gitcafe: git@gitcafe.com:kunr/kunr.git, gitcafe-pages
```

请把上面的 `Kunr` 替换成自己的用户名，
更新站点，只需要 `hexo d -g` 这一句命令。

### 文章

#### 创建新文章

```bash
hexo new [layout] <title>
```

他会在你博客目录下的 `sources/_post` 创建一个 `<title>.md` 的文件
layout 有种默认的 post 和 page。
其他的当然可以自己添加。

#### 文章摘要

和我们熟知的的 WordPress / Typecho 一样 都可以使用

```
<!--more-->
```

#### 第三方评论

Hexo 中的 modernist 主题已经支持直接添加第三方评论代码，打开 `themes\modernist\layout_partial\comment.ejs` ，将你的第三方评论代码添加进去即可。

```
<% if (config.disqus_shortname && page.comments){ %>
<section id="comment">
#评论代码
<% } %>
```

#### Markdown编辑器

你可以使用他： [https://stackedit.io/](https://stackedit.io/)
一个不错的编辑器。
或者看 [http://wowubuntu.com/markdown/](http://wowubuntu.com/markdown/) 来学习 Markdown

### 一些问题

#### 如何配置我的菜单？

打开主题下面的：_config.yml 文件

```yaml
menu:
  Home: /
  About: /about
  Archives: /archives
  Links: /links
  FM: http://dsu.pw/fm
  Lingoys!Art: http://www.lingoys.com
  rss: /atom.xml
```

类似上面的格式

#### 如何生成 rss / sitemap

安装 所提供的插件 `hexo-generator-feed` 和 `hexo-generator-sitemap`
安装方式

```bash
npm install <plugin-name> --save
```

然后往 _config.yml 里加入

```yaml
plugins:
  - hexo-generator-sitemap
  - hexo-generator-feed
#sitemap
sitemap:
  path: sitemap.xml
#feed
feed:
  type: atom
  path: atom.xml
  limit: 20
```

下次生成的时候就有 atom.xml 和 sitemap.xml 惹！

* * *

完
